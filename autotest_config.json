{
  "description": "Example autotest configuration demonstrating warning and error message validation from scan output",
  "version": 1.5,
  "_usage_notes": "This example shows how to validate scan warnings and errors that appear in the Scan Details Report table. The scan_details_report field supports validating specific table entries with filePath, description, and details.",

  "base_config": {
    "validate_scan_output": true,
    "scan_output": {
      "security_scan_report_conclusion": "success",
      "_comment_conclusion": "Set to 'success' if scan completes despite warnings, or 'failure' if errors cause scan to fail",

      "total_libs_scanned": {"eq": 0},
      "_comment_total_libs": "For cases where installation fails, no libraries are scanned",
      "expected_messages": [
             {
               "operator": "contains",
               "value": "The scan wasn't completed due to the issues encountered while retrieving or scanning dependencies for the following package managers: uv.",
               "level": "error",
               "_comment": "Main error message validation"
             },
             {
               "operator": "contains",
               "value": "Preparing the project for scan",
               "level": "warning",
               "scan_details_report": {
                 "filePath": ".*pyproject\\.toml",
                 "description": "One or more of the installations failed",
                 "details": "The current Python platform is not compatible with the lockfile's supported environments: sys_platform == 'darwin'"
               }
             },
             {
               "operator": "contains",
               "value": "Resolving the project",
               "level": "error",
               "scan_details_report": {
                 "filePath": ".*pyproject\\.toml",
                 "description": "The resolution operation failed due to a component used in the resolution operation that was not found",
                 "details": "No libraries installed in environment. Project declares 9 dependencies. Please install the environment (e.g., run 'uv sync') before scanning."
               }
             }
           ]
    },

    "validate_dependency_tree": false,
    "_comment_dependency_tree": "Disabled since no dependencies are expected when installation fails",

    "dependency_tree": {
      "check_dependency_tree_detection_status": false
    },

    "validate_vulnerabilities_table": false,
    "_comment_vulnerabilities": "Disabled since no vulnerabilities are expected with 0 libraries scanned",

    "vulnerabilities_table": {
      "check_vulnerabilities_table_structure": false
    },

    "validate_scanner_logs": false,

    "validate_reachability": false,
    "reachability": {
      "check_reachability_status": false
    }
  }
}
